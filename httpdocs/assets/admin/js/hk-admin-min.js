var badmin_reload=function(e){if(BCOMMON.isOk(e))return e.data.isReload&&$("button#"+BJGRID.idButtonFilter).trigger("click"),void BALERT.show("",e.data.message,BALERT.TYPE.success);BALERT.show("",e.error,BALERT.TYPE.error)},badmin_formAfter=function(e){if(BCOMMON.isOk(e)){if(BALERT.show("",e.data.message,BALERT.TYPE.success),e.data.isComeback&&"none"==e.data.isComeback)return"function"==typeof window.badmin_formAfterIndex?(0,window.badmin_formAfterIndex)(e):void 0;if(e.data.isReload)return void window.location.reload();if("function"==typeof window.badmin_formAfterIndex)return(0,window.badmin_formAfterIndex)(e);$("form")[0].reset();try{for(instance in $("input."+BPHOTO.classPhotoSingle).next("img").attr("src",BPHOTO.urlNoImage),$("div."+BPHOTO.classPhotoSingle).find("div.col-sm-3.rb-div-photo-remove").each(function(){$(this).parent().remove()}),$("input[type=hidden][rb-ref-class="+BPHOTO.classPhotoSupport+"]").val(""),$("input."+BPHOTO.classPhoto).next("img").attr("src",BPHOTO.urlNoImage),$("div."+BPHOTO.classPhoto).find("div.col-sm-3.rb-div-photo-remove").each(function(){$(this).parent().remove()}),$("div."+BPHOTO.classCollection).find("div.col-sm-3.rb-div-photo-remove").each(function(){$(this).parent().remove()}),CKEDITOR.instances)CKEDITOR.instances[instance].updateElement(),CKEDITOR.instances[instance].setData("");$("a#rb-admin-add-photo").trigger("click"),$("a#rb-entity-collection-add").trigger("click")}catch(e){}e.data.isComeback&&window.history.back()}else BALERT.show("",e.error,BALERT.TYPE.error)},badmin_menuControlBefore=function(e){var t=Array();if($("div.rb-table-render input[type=checkbox]."+BJGRID.classCheckBoxListId).each(function(){var e=$(this);BFORM.CHECKBOX.isChecked(e)&&t.push(parseInt(BOB.getId(e),10))}),t.length<=0)return BALERT.show("",BOB.getAdminCheckedRequireError($("#"+BADMIN.idAdminMenuControl)),BALERT.TYPE.error),!1;var i=BJSON.stringToJSON(BOB.getParams(e));return i.ids=t,BOB.setParams(e,BJSON.JSONToString(i)),!0},BPHOTO={currentPhoto:null,classPhotoSingle:"rb-photo-single",classPhotoSupport:"rb-photo-support",classPhoto:"rb-photo",classCollection:"rb-entity-collection",urlNoImage:"/assets/admin/img/no-img.png",initPhotoSingle:function(){$("input[type=text].rb-check."+BPHOTO.classPhotoSingle).each(function(){var e=$(this),t=e.val();""==t&&(t=BPHOTO.urlNoImage);var i=$('<img src="'+t+'" style="width:120px;cursor: pointer"/>'),n=$('<i class="fas fa-sync-alt" style="cursor: pointer; margin-left: 5px; top: 0px; position: absolute" title="click here"></i>');e.parent().append(i).append(n),i.click(function(){$("#rb-modal-media").modal("show"),BPHOTO.currentPhoto=$(this)}),n.click(function(){i.trigger("click")})})},addCollection:function(e){BPHOTO.checkPhotoSelect(e);var t=$("div."+e),i=function(e){e.addClass("border-bottom");var t=$('<a href="'+BCOMMON.VOID+'" class=""><i class="far fa-trash-alt text-danger"></i></a>');e.append($('<div class="col-sm-3 rb-div-photo-remove"></div>').append(t)),t.click(function(e){e.preventDefault(),$(this).parent().parent().remove()})},n=function(e){e.find("> div.form-group label.col-sm-3").each(function(){$(this).remove()})};n(t);var a=$('<a id="rb-entity-collection-add" href="'+BCOMMON.VOID+'" class=""><i class="fas fa-plus"></i></a>'),r=$('<div class="form-group text-right"></div>').append(a);t.find("> div.form-group").each(function(){i($(this))}),t.append(r),t.data("index",t.find(":input").length),a.click(function(e){e.preventDefault(),function(e,t){var a=e.data("prototype"),r=e.data("index"),o=$(a.replace(/__name__/g,r));e.data("index",r+1),t.before(o),i(t.prev()),n(e)}(t,r)})},iwSelect:function(e){null!=BPHOTO.currentPhoto&&(BPHOTO.currentPhoto.attr("src",e),BPHOTO.currentPhoto.prev("input[type=text].rb-check."+BPHOTO.classPhotoSingle).val(e),BPHOTO.currentPhoto.next().find("input[type=hidden]").val(e),$("input[type=hidden][rb-ref-class="+BPHOTO.classPhotoSupport+"]").val("1"),$("input[type=hidden][rb-ref-class="+BPHOTO.classPhoto+"]").val("1"),$("#rb-modal-media").modal("hide"))},checkPhotoSelect:function(e){$("input[type=hidden][rb-ref-class="+e+"]").val(""),$("div."+e+" input[type=hidden]").each(function(){$ob=$(this),""!=$ob.val()&&$("input[type=hidden][rb-ref-class="+e+"]").val("1")})},addPhotoCollection:function(e){BPHOTO.checkPhotoSelect(e);var t=$("div."+e),i=function(t){t.addClass("border-bottom");var i=t.find("input[type=hidden]").val();""==i&&(i=BPHOTO.urlNoImage);var n=$('<img src="'+i+'" style="width:120px;cursor: pointer"/>'),a=$('<a href="'+BCOMMON.VOID+'" class=""><i class="far fa-trash-alt text-danger"></i></a>');t.find("> div.col-sm-9").prepend(n),t.append($('<div class="col-sm-3 rb-div-photo-remove"></div>').append(a)),n.click(function(){$("#rb-modal-media").modal("show"),BPHOTO.currentPhoto=$(this)}),a.click(function(t){t.preventDefault(),$(this).parent().parent().remove(),BPHOTO.checkPhotoSelect(e)})},n=function(e){e.find("> div.form-group label.col-sm-3").each(function(){$(this).remove()})};n(t);var a=$('<a id="rb-admin-add-photo" href="'+BCOMMON.VOID+'" class="add-photo"><i class="fas fa-plus"></i></a>'),r=$('<div class="form-group text-right mr-5"></div>').append(a);t.find("> div.form-group").each(function(){i($(this))}),t.append(r),t.data("index",t.find(":input").length),a.click(function(e){e.preventDefault(),function(e,t){var a=e.data("prototype"),r=e.data("index"),o=$(a.replace(/__name__/g,r));e.data("index",r+1),t.before(o),i(t.prev()),n(e)}(t,r)})}},BADMIN={idAdminMenuControl:"rb-admin-menu-control",classAdminMenuControl:"rb-admin-menu-control",reInit:function(){$("input.rb-datepicker").datepicker({format:"dd/mm/yyyy"}),BPHOTO.addPhotoCollection(BPHOTO.classPhoto),BPHOTO.addCollection(BPHOTO.classCollection);var e=-1;$("input.rb-edit-id")&&(e=$("input.rb-edit-id").val()),parseInt(e,10)<=0&&($("a#rb-admin-add-photo").trigger("click"),$("a#rb-entity-collection-add").trigger("click")),$(".rb-reinit-url").each(function(){var e=$(this);e.unbind("click").click(function(){var t=BOB.getUrl(e);if(""!=t){if(parseInt(BOB.getId(e),10)>0&&(t+="/"+BOB.getId(e)),"1"==BOB.getIsConfirm(e))return void BMODAL.add(BOB.getIsConfirmText,function(){var i=BOB.getCallBackBefore(e);"function"!=typeof window[i]?window.location=t:(0,window[i])(e)&&(window.location=t)});var i=BOB.getCallBackBefore(e);if("function"==typeof window[i])return void((0,window[i])(e)&&(window.location=t));window.location=t}})}),$("select#"+BJGRID.idSelectLimit).unbind("change").change(function(){var e=$(this);BJGRID.limit=e.val(),BJGRID.page=1,$("button#"+BJGRID.idButtonFilter).trigger("click")}),$("ul#"+BJGRID.idUlPaginator+" li.page-item > a.page-link").each(function(){$(this).unbind("click").click(function(){var e=$(this);""!=BOB.getPage(e)&&(BJGRID.page=BOB.getPage(e),$("button#"+BJGRID.idButtonFilter).trigger("click"))})}),$("div.rb-table-render input[type=checkbox]#"+BJGRID.idCheckBoxAll).unbind("click").click(function(){var e=$(this),t=$("div.rb-table-render input[type=checkbox]."+BJGRID.classCheckBoxListId);BFORM.CHECKBOX.isChecked(e)?BFORM.CHECKBOX.checkAllList(t,!BFORM.CHECKBOX.isCheckedAll($("div.rb-table-render input[type=checkbox]."+BJGRID.classCheckBoxListId))):BFORM.CHECKBOX.checkAllList(t,!1)}),$("div.rb-table-render input[type=checkbox]."+BJGRID.classCheckBoxListId).each(function(){$(this).unbind("click").click(function(){BFORM.CHECKBOX.check($("div.rb-table-render input[type=checkbox]#"+BJGRID.idCheckBoxAll),BFORM.CHECKBOX.isCheckedAll($("div.rb-table-render input[type=checkbox]."+BJGRID.classCheckBoxListId)))})}),$(".admin-toggle-on").toggles({drag:!1,click:!0,text:{on:"ON",off:"OFF"},on:!0,animate:250,easing:"swing",checkbox:null,clicker:null,type:"compact"}),$(".admin-toggle-off").toggles({drag:!1,click:!0,text:{on:"ON",off:"OFF"},on:!1,animate:250,easing:"swing",checkbox:null,clicker:null,type:"compact"})},init:function(){$("input.rb-validate-multi-select-required").each(function(){var e=$(this);BFORM.CHECKBOX.isCheckedOne($("div."+BOB.getRefClass(e)+' input[type="checkbox"]'))&&e.val("1"),$("div."+BOB.getRefClass(e)+' input[type="checkbox"]').unbind("click").click(function(){e.val(""),BFORM.CHECKBOX.isCheckedOne($("div."+BOB.getRefClass(e)+' input[type="checkbox"]'))&&e.val("1")})}),$("textarea.rb-editor").parent().addClass("col-sm-12"),$("textarea.rb-editor").parent().prev("label").addClass("col-sm-12"),$("div.rb-limit-render").each(function(){var e=$(this);BJGRID.renderLimit(e)}),$("div.rb-filter-form-render").each(function(){var e=$(this),t=BOB.getUrl(e);t&&BAJAX.send(t,{},function(t){BCOMMON.isOk(t)&&(BJGRID.renderFilter(t.data,e),BFORM.reInit(),$("button#"+BJGRID.idButtonFilter).trigger("click"))})}),$("div.rb-admin-menu-control").each(function(){var e=$(this),t=BOB.getUrl(e);""!=t&&(e.html(""),BAJAX.send(t,{},function(t){if(BCOMMON.isOk(t)){for(var i=0;i<t.data.length;i++){var n=t.data[i];e.append('<a href="'+BCOMMON.VOID+'" class="'+n.class+'" rb-data-url="'+n.url+'" rb-data-method="'+n.method+'" '+n.attr+'><i class="'+n.icon+'"></i> '+n.text+"</a>")}BADMIN.reInit(),BCOMMON.reInit(),BFORM.reInit()}}))}),$("form .rb-check").each(function(){var e=$(this);"1"==BOB.getValidateRequired(e)&&e.parent().prev("label").append('<span class="badge badge-danger badge-indicator"></span>')}),$("form .rb-check").length>0&&"1"==BOB.getIsMultiLanguages($("#rb-section-form"))&&BAJAX.send("/admin/language/all",{},function(e){if(BCOMMON.isOk(e)){let t=-1;if($("input.rb-edit-id")&&(t=$("input.rb-edit-id").val()),""!=BOB.getUrl($("#rb-section-form")))return void BAJAX.send(BOB.getUrl($("#rb-section-form")),{id:t},function(t){BCOMMON.isOk(t)&&BADMIN.renderMultiLanguages(e,t)});BADMIN.renderMultiLanguages(e,[])}}),BPHOTO.initPhotoSingle()},renderMultiLanguages:function(e,t){let i="";e.data.forEach(e=>{e.is_default&&(i=e.key)}),$("form .rb-check").each(function(){var n=$(this);if("1"==BOB.getIsMultiLanguages(n)){var a='<ul class="rb-nav-lang nav nav-tabs nav-tabs-success nav-light pa-5 mb-5 justify-content-end" rb-data-current-lang="'+i+'">';e.data.forEach(e=>{var i="",r="";if(e.is_default)i=" active";else{r="_"+e.key;var o=n.clone();o.attr("id",n.attr("id")+"_"+e.key),o.attr("name",n.attr("name").replace("]","_"+e.key+"]"));var c=n.attr("id").split("_");try{o.val(t.data[e.key][c[c.length-1]])}catch(e){}n.parent().append(o),n.hasClass("rb-editor")?BFORM.FORM.renderEditor(o,function(){o.next("div.cke.cke_reset").addClass("d-none")}):o.addClass("d-none")}a+='<li class="nav-item "><a href="'+BCOMMON.VOID+'" rb-ref-id="'+n.attr("id")+r+'" class="nav-link font-11 pl-5 pr-5'+i+'" rb-data-lang="'+e.key+'">'+e.lang+"</a></li>"}),a+="</ul>",n.parent().prepend(a),n.parent().find("ul.rb-nav-lang li > a").unbind("click").click(function(){var e=$(this),t=n.parent().find("ul.rb-nav-lang");if(BOB.getLang(e)!=BOB.getCurrentLang(t)){if(n.parent().find("ul.rb-nav-lang li > a").removeClass("active"),e.addClass("active"),BOB.setCurrentLang(t,BOB.getLang(e)),n.hasClass("rb-editor"))return $("#"+BOB.getRefId(e)).parent().find("div.cke.cke_reset").removeClass("d-none").addClass("d-none"),void $("#"+BOB.getRefId(e)).next("div.cke.cke_reset").removeClass("d-none");$("#"+BOB.getRefId(e)).parent().find(".rb-check").removeClass("d-none").addClass("d-none"),$("#"+BOB.getRefId(e)).removeClass("d-none")}})}})}};$(function(){BADMIN.init(),BADMIN.reInit()});